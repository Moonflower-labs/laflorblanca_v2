import{r as u,j as e,A as h,m as j,g as f,p as n,s as g,u as v,h as y,i as b,f as N}from"./index-BW1M4ofp.js";import{f as w,F as k,C as F,L,i as C,a as D}from"./helpers-CX6dfm75.js";const V=({hasRated:a})=>{const[s,t]=u.useState(!1);return u.useEffect(()=>{t(!1)},[a]),e.jsx("div",{className:"flex flex-col gap-3 my-auto",children:e.jsxs(h,{children:[e.jsx("button",{className:"me-2 btn btn-primary",onClick:()=>t(!s),disabled:a,children:a?"Ya has valorado esta respuesta":"Valora esta respuesta"}),s&&e.jsx(j.div,{initial:{y:-50,opacity:0,scale:0},animate:{y:0,opacity:1,scale:1},transition:{duration:.4},exit:{y:-50,scale:0},children:e.jsxs(f,{method:"post",className:"rating rating-md gap-1 my-auto border p-3 rounded-md bg-secondary/15 align-middle",children:[e.jsx("input",{type:"hidden",name:"intent",value:"rating"}),e.jsx("input",{type:"radio",name:"rating-value",className:"mask mask-heart bg-primary",defaultValue:1}),e.jsx("input",{type:"radio",name:"rating-value",className:"mask mask-heart bg-primary",defaultValue:2}),e.jsx("input",{type:"radio",name:"rating-value",className:"mask mask-heart bg-primary",defaultValue:3,defaultChecked:!0}),e.jsx("button",{className:"btn btn-sm",children:"Votar"})]})},"rating")]})})},R=async({params:a})=>{const s=await n.getPost(a.id);return{post:(s==null?void 0:s.post)||null}},_=async({request:a,params:s})=>{const t=await a.formData();switch(t.get("intent")){case"like":return await g(t);case"rating":return await n.ratePost(s.id,t);case"favorite":return await n.addToFavorites(s.id,t);default:throw new Response("",{status:405})}};function B(){var r,o,d,c,m,x;const{post:a}=v()||{post:null},{user:s}=y("root")||{user:null},t=a&&((o=(r=s==null?void 0:s.profile)==null?void 0:r.favorite_posts)==null?void 0:o.some(i=>(a==null?void 0:a.id)!==void 0&&i===(a==null?void 0:a.id))),l=(d=a==null?void 0:a.rating_score)==null?void 0:d.authors.includes(s==null?void 0:s.id),p=(c=s==null?void 0:s.likes)==null?void 0:c.liked_comments;return e.jsx(e.Fragment,{children:a?e.jsxs(e.Fragment,{children:[e.jsxs("article",{className:"pb-6 pt-16 px-10 md:px-40",children:[e.jsx("h2",{className:"text-primary font-semibold text-2xl text-center mt-4 mb-3",children:a.title}),e.jsx("p",{className:"whitespace-pre-wrap mb-8",children:a.body}),e.jsxs("p",{className:"mb-4",children:["La Flor Blanca el ",w(a.created)]}),e.jsx("div",{className:"divider divider-primary md:w-2/3 mx-auto",children:e.jsx("span",{className:"text-primary",children:e.jsx(b,{size:34})})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 align-middle",children:[e.jsxs("div",{className:"flex flex-row justify-between w-[50%]",children:[e.jsx(k,{object:a,isFavorite:!!t}),e.jsx("div",{className:"flex gap-4 align-middle",children:e.jsxs("div",{className:"shadow my-auto",children:[e.jsx("div",{className:"stat-title",children:"Puntuación"}),e.jsx("div",{className:"stat-value",children:(m=a==null?void 0:a.rating_score)==null?void 0:m.score.toFixed(1)}),e.jsxs("div",{className:"stat-desc",children:["Votaciones ",(x=a==null?void 0:a.rating_score)==null?void 0:x.votes]})]})})]}),e.jsx(V,{hasRated:l||!1})]})]}),e.jsxs("h2",{className:"flex gap-4 align-middle text-primary justify-center font-semibold text-2xl mt-4 mb-3",children:["Comentarios ",e.jsx(N,{size:24,className:"my-auto"})]}),e.jsx("div",{className:"md:px-40 mb-6 max-h-44 bg-primary/20 rounded-md mx-4 overflow-y-auto",children:a.comments&&a.comments.length?a.comments.map(i=>e.jsxs("div",{className:"flex flex-row gap-4 align-middles",children:[e.jsx(F,{comment:i}),e.jsx(L,{object:"comment",id:i.id,isLiked:C(i.id,p)})]},i.id)):e.jsx("p",{className:"text-xl text-center",children:"Nadie ha comentado todavía."})}),e.jsx(D,{object:a,fieldName:"post"})]}):e.jsx("div",{className:"text-3xl text-center h-full my-auto",children:"No hemos encontrado el post."})})}export{B as BasicDetail,_ as basicDetailAction,R as basicDetailLoader};
